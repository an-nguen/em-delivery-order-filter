# Решение для тестового задания

Само тестовое задание:

Необходимо разработать консольное приложение (по желанию можно WinForms либо WebApi) для службы доставки, которое фильтрует заказы в зависимости от количества обращений в конкретном районе города и времени обращения с и по.

Входные данные для каждой строки содержат следующую информацию:

- Номер заказа - можно использовать уникальный идентификатор или придумать свой;
- Вес заказа в килограммах;
- Район заказа, можно придумать либо название либо идентификатор района;
- Время доставки заказа - в формате: yyyy-MM-dd HH:mm:ss.

Для исходных данных можно использовать либо файл с данными (рекомендуется) либо любые СУБД, которые можно легко установить для проверки.

Также необходимо сделать логирование основных операций, а также валидацию входных данных.

В результирующий файл либо БД необходимо вывести результат фильтрации заказов для доставки в конкретный район города в ближайшие полчаса после времени первого заказа.

Данные для фильтрации (можно передавать через параметры консольного приложения _cityDistrict, _firstDeliveryDateTime):

- Район доставки;
- Время первой доставки.

Выходные файлы:

- логирование - в случае консольного приложения определить задание адреса файла через командную строку: 
_deliveryLog - путь к файлу с логами, либо создать в СУБД таблицу с логами;
- результат - записывать по адресу: _deliveryOrder - путь к файлу с результатом выборки либо в СУБД таблицу.

По возможности, кроме передачи параметров через командную строку либо форму, 
можно реализовать частичную либо полную передачу параметров через файлы конфигурации или переменные среды.

Программа не должна ломаться от некорректных входных данных (реализовать в валидации), 
ошибок ввода-вывода и прочим причинам, 
которые можно предусмотреть (реализовать обработку возможных ошибок).

Решение должно быть предоставлено в виде исходных кодов в архиве, 
при необходимости с дампом базы данных, в виде архива или ссылки на репозиторий с решением.

Код должен быть оптимальным, читаемым для разработчика и удобным для
пользователя, при разработке желательно покрытие несколькими тестами и
использование общераспространенных практик (паттерны проектирования, KISS…)

Результат тестового задания должен содержать текстовый файл readme.txt с
инструкцией по настройке и конфигурированию приложения (если необходимо).

## Используемые пакеты

- Spectre.Console (для простой работы с аргументами командной строки, также умеет выводить графические элементы в консоль);
- XUnit (фреймворк для написания тестов);

## Структура проекта

```
.
├── README.md                     // Описание проекта
├── DeliveryOrderFilter.sln       // Файл решения
├── OrderFilter
│   ├── MainCommand.cs              // Класс MainCommand отвечающий за логику
│   ├── data.json                   // Входные данные содержащий список заказов
│   ├── Logger.cs                   // Класс логирования
│   ├── Converters                  
│   │   └── DateTimeOffsetConv.cs   // Класс-конвертер даты и времени 
│   ├── Models
│   │   ├── OrderRepository.cs      // Класс репозиторий 
│   │   └── Order.cs                // Класс сущности
│   ├── OrderFilter.csproj          // Файл проекта
│   ├── my-config.json              // Конфигурационный файл (необязательно)
│   └── Program.cs                  // Entry point
└── OrderFilter.Tests
    ├── MainCommandTest.cs          // Тесты MainCommandTest
    ├── data.json                   // Копируется в директорию с исполняемым файлом
    ├── DateTimeOffsetConv.cs       // Тесты для класса DateTimeOffsetConv
    ├── OrderFilter.Tests.csproj    // Файл проекта для тестов
    ├── TestData.cs                 // Константы
    └── OrderRepositoryTest.cs      // Тест класса репозитория OrderRepository
```

## Запуск

Пример выполнения:
```
$ cd .\OrderFilter\ && dotnet run -- --help
USAGE:
    OrderFilter.dll [OPTIONS]

OPTIONS:
                                      DEFAULT
    -h, --help                                       Prints help information
        --config                                     A config file that match to command line options
    -i, --input-file                  data.json      The input data file in JSON format
    -c, --city-district                              A city district (required)
    -d, --first-delivery-date-time                   A first delivery date time in a format defined by current system locale (required)
    -l, --delivery-log                log.txt        A file path to the output log file (default is 'log.txt')
    -o, --delivery-order              orders.json    A file path to the output order file (default is 'orders.json')

$ dotnet run -- --city-district 'Ульяновск, Засвияжский район' --first-delivery-date-time '2024-01-16 10:30:00'
┌──────────────────────────────────────┬────────┬──────────────────────────────┬────────────────────────────┐
│ ID                                   │ Weight │ City District Name           │ Delivery Date Time         │
├──────────────────────────────────────┼────────┼──────────────────────────────┼────────────────────────────┤
│ fe16871c-0c85-45e1-9580-72d1447a65d4 │ 0,15   │ Ульяновск, Засвияжский район │ 16.01.2024 10:40:00 +04:00 │
└──────────────────────────────────────┴────────┴──────────────────────────────┴────────────────────────────┘
```

## Что можно улучшить (с точки зрения автора)

- функция по фильтрации данных можно вынести в отдельный класс-сервис (она сейчас находится в классе MainCommand в качестве private метод, +возможность добавить unit-тест, -KISS);
- методы для вывода в консоль из MainCommand в отдельный класс (-KISS, +Single Responsibility наверное);